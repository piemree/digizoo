<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />

    <style>
      body {
        position: relative;
        background-color: black;
      }
      .video {
        position: fixed;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: none;
      }
      .show {
        display: block;
      }
    </style>
    <title>DOG MASTER</title>
  </head>

  <body>
    <video
      id="video"
      class="video show"
      loop
      autoplay
      src="../runner_videos/kopek_bekle.mp4"
    ></video>
    <video
      id="video-sev"
      class="video"
      muted
      src="../runner_videos/kopek_sev.mp4"
    ></video>
    <video
      id="video-besle"
      class="video"
      muted
      src="../runner_videos/kopek_besle.mp4"
    ></video>

    <script src="./socket.io.min.js"></script>
    <script type="text/javascript">
      var socket = io("http://localhost:3000");

      const video = document.getElementById("video");
      const videoSev = document.getElementById("video-sev");
      const videoBesle = document.getElementById("video-besle");

      const mainVideoUrl = "../runner_videos/kopek_bekle.mp4";
      const sevVideoUrl = "../runner_videos/kopek_sev.mp4";
      const besleVideoUrl = "../runner_videos/kopek_besle.mp4";

      function timeUpdateHandler() {}

      videoSev.addEventListener("ended", function (data) {
        socket.emit("sev-stop");
        videoSev.classList.remove("show");
        videoSev.muted = true;
        videoBesle.classList.remove("show");
        videoBesle.muted = true;

        video.classList.add("show");
        video.muted = false;
        video.currentTime = 1;
        video.play();
      });
      videoBesle.addEventListener("ended", function (data) {
        socket.emit("besle-stop");
        videoSev.classList.remove("show");
        videoSev.muted = true;
        videoBesle.classList.remove("show");
        videoBesle.muted = true;

        video.classList.add("show");
        video.muted = false;
        video.currentTime = 0.5;
        video.play();
      });

      socket.on("sev-master", function (data) {
        const playingNow =
          videoSev.classList.contains("show") ||
          videoBesle.classList.contains("show");
        if (playingNow) return;
        socket.emit("sev-start");
        video.classList.remove("show");
        video.muted = true;
        videoBesle.muted = true;
        videoBesle.classList.remove("show");

        videoSev.classList.add("show");
        videoSev.muted = false;
        videoSev.currentTime = 4;
        videoSev.play();
      });
      socket.on("besle-master", function (data) {
        const playingNow =
          videoSev.classList.contains("show") ||
          videoBesle.classList.contains("show");
        if (playingNow) return;
        socket.emit("besle-start");
        video.classList.remove("show");
        video.muted = true;
        videoSev.classList.remove("show");
        videoSev.muted = true;

        videoBesle.classList.add("show");
        videoBesle.muted = false;
        videoBesle.currentTime = 9;
        videoBesle.play();
      });
      socket.on("connect", function (data) {
        console.log("connection connection");
      });
    </script>
  </body>
</html>
